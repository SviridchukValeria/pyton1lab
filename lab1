import pandas as pd

# Чтение данных
df = pd.read_csv('C:/piton/Titanic-Dataset.csv')

print("=== АНАЛИЗ ДАННЫХ TITANIC ===")

# Основная информация о данных
print(f"Размер данных: {df.shape[0]} строк, {df.shape[1]} столбцов")
print("\nПервые 5 строк:")
print(df.head())
print("\nИнформация о данных:")
df.info()

# Обработка пропущенных значений
print("\n=== ОБРАБОТКА ПРОПУЩЕННЫХ ЗНАЧЕНИЙ ===")
missing_before = df.isnull().sum()
print("Пропуски до обработки:")
print(missing_before[missing_before > 0])

# Заполнение пропусков
df.fillna({
    'Age': df['Age'].median(),
    'Embarked': df['Embarked'].mode()[0],
    'Cabin': 'Unknown'
}, inplace=True)

print("\nПропуски после обработки:")
print(df.isnull().sum().sum(), "пропусков осталось")

# Нормализация числовых данных (только выбранных столбцов)
print("\n=== НОРМАЛИЗАЦИЯ ЧИСЛОВЫХ ДАННЫХ ===")
numeric_cols = ['Age', 'Fare', 'SibSp', 'Parch']
for col in numeric_cols:
    if col in df.columns:
        df[col] = (df[col] - df[col].min()) / (df[col].max() - df[col].min())
        print(f"Нормализован {col}")

# Преобразование категориальных данных
print("\n=== ПРЕОБРАЗОВАНИЕ КАТЕГОРИАЛЬНЫХ ДАННЫХ ===")
categorical_cols = ['Sex', 'Embarked']
df = pd.get_dummies(df, columns=categorical_cols, drop_first=True)
print("Категориальные данные преобразованы")

# Итоговый результат
print("\n=== РЕЗУЛЬТАТ ===")
print(f"Итоговый размер: {df.shape[0]} строк, {df.shape[1]} столбцов")
print("\nПервые 3 строки после обработки:")
print(df.head(3))

# Сохранение результата
df.to_csv("titanic_processed.csv", index=False)
print(f"\nДанные сохранены в 'titanic_processed.csv'")

# Дополнительная информация
print("\n=== СВОДКА ===")
print(f"Обработано столбцов: {len(df.columns)}")
print("Типы данных после обработки:")
print(df.dtypes.value_counts())
